import{h}from"hyperapp";import uuid from"uuid/v4";var renderers=[],container=null,recaptchaId=null,injectScript=function(e){window.GoogleRecaptchaLoaded=function(){for(;renderers.length;){renderers.pop()()}};var t=document.createElement("script");t.id="recaptcha",t.src="https://www.google.com/recaptcha/api.js?hl="+e+"&onload=GoogleRecaptchaLoaded&render=explicit",t.type="text/javascript",t.async=!0,t.defer=!0,t.onerror=function(e){throw e},document.body.appendChild(t)},destroyRefs=function(){for(;container.firstChild;)container.removeChild(container.firstChild);window.grecaptcha.reset(recaptchaId),delete window[callbackName]},createRecaptcha=function(e){var t=e.sitekey,c=e.locale,n=void 0===c?"en":c,r=e.badge,a=void 0===r?"bottomright":r,o=e.onResolved,i=e.onLoaded,d=void 0===i?function(){}:i,p=e.onInstanceCreated,h="GoogleRecaptchaResolved-"+uuid();window[h]=o;var u=function(){if(container){var e=document.createElement("div");recaptchaId=window.grecaptcha.render(container,{sitekey:t,size:"invisible",badge:a,callback:h}),container.appendChild(e),p({execute:function(){return window.grecaptcha.execute(recaptchaId)},reset:function(){return window.grecaptcha.reset(recaptchaId)},getResponse:function(){return window.grecaptcha.getResponse(recaptchaId)}}),d()}};window.grecaptcha?u():(renderers.push(u),document.querySelector("#recaptcha")||injectScript(n))},InvisibleRecaptcha=function(e){return h("div",{oncreate:function(t){container=t,createRecaptcha(e)},ondestroy:function(){return destroyRefs()}},[])};export default InvisibleRecaptcha;
